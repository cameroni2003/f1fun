---
import { type GetStaticPaths } from "astro";
import { Prisma } from "@prisma/client";
import prisma from "../../../prisma/db";
import { boolean } from "astro/zod";
import BaseLayout from "../../layouts/BaseLayout.astro";
import DataTable from "react-data-table-component";
import { ListTable } from "root/src/components/ListTable";

const columns = [
  {
    name: "Title",
    selector: (row) => row.title,
  },
  {
    name: "Year",
    selector: (row) => row.year,
  },
];

const data = [
  {
    id: 0,
    title: "Beetlejuice",

    year: "1987",
  },
  {
    id: 1,
    title: "Ghostbusters",
    year: "1983",
  },
];

export const getStaticPaths = (async () => {
  const drivers = await prisma.drivers.findMany();
  console.log("generating paths");
  return drivers.map((driver) => {
    return { params: { driverId: driver.driverRef } };
  });
}) satisfies GetStaticPaths;

const { driverId } = Astro.params;
const drivers = await prisma.drivers.findMany({
  include: { results: true },
});

const tableData = drivers.map((d) => {
  return {
    driverName: `${d.forename} ${d.surname}`,
  };
});
---

<BaseLayout>
  <DataTable client:only="react" columns={columns} data={data} />
</BaseLayout>
